{%- block field -%} {# this block exists for whitespace control #}
{%- set errors = errors | default([]) -%}
{%- set input_help = translations.input_help | default('') -%}
{%- set input_hint = translations.input_hint | default('') -%}
{%- set input_focus_hint = translations.input_focus_hint | default('') -%}

{# Notifications about list constraints to respect #}
{% set min_constraint = _('min', translation_domain) %}
{% set max_constraint = _('max', translation_domain) %}
{% set field_constraints = '' %}
{% if widget_options.min_count is not null or widget_options.max_count is not null %}
    {% set field_constraints = '(%s: %s, %s: %s)'|format(min_constraint, widget_options.min_count|default('-'), max_constraint, widget_options.max_count|default('-')) %}
{% endif %}

<div
    class="hb-field hb-field__embedded-entity-list {{ css|default('') }}"
    {% if widget_enabled %} data-jsb="{{ widget_options|json_encode }}" {% endif %}
    data-hb-field-name="{{ field_name }}" {% for attr, val in html_attributes %} {{ attr }}="{{ val }}" {% endfor %}>
    <div class="hb-field__content">
        <div class="hb-embed-type-selector">
            {{ rendered_embed_selector|raw }}
        </div>
        {% if options.hide_attribute_label is not defined or not options.hide_attribute_label %}
        <div class="hb-field__label">
            <label for="{{ field_id }}" class="{#mandatory#}">
                {{ _(field_name~'.field_name', translation_domain) }} {{ field_constraints }}
            </label>
        </div>
        {% endif %}
    </div>
    <div class="hb-field__value">
        <ul class="errors">
            {%- block field_errors  -%}
                {%- for error in errors -%}
                    <li class="error">{{error}}</li>
                {%- endfor -%}
            {%- endblock  -%}
        </ul>
        {% if input_help %}
            <div class="input_help">{{ input_help|raw }}</div>
        {% endif %}
        {% if input_hint %}
            <div class="input_hint">{{ input_hint|raw }}</div>
        {% endif %}
        {% if input_focus_hint %}
            <div class="input_hint focus">{{ input_focus_hint|raw }}</div>
        {% endif %}
        <input type="checkbox" class="hb-field__list-validity visuallyhidden" required checked />
        <input type="hidden" name="{{ grouped_field_name }}" value="" />
        <ul class="hb-entity-list">
        {%- for rendered_entity in rendered_entities -%}
            {{- rendered_entity|raw -}}
        {%- endfor -%}
        </ul>
        <ul class="hb-entity-list hb-entity-templates {% if inline_mode %}visuallyhidden{% endif %}" data-fpf-ignore>
        {%- for rendered_type_tpl in rendered_type_templates -%}
            {{- rendered_type_tpl|raw -}}
        {%- endfor -%}
        </ul>
    </div>
    <div class="hb-field__extra">
    </div>
</div>
{%- endblock field -%}
